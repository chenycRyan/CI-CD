/*!
 *  build: HuiBo-Admin 
 *   time: 2022-9-14 17:23:05
 */
(window["webpackJsonp_huibo"]=window["webpackJsonp_huibo"]||[]).push([["chunk-933ee022"],{"18e9":function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"school-container"},[e("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"学院概况",name:"first"}},["first"===t.activeName?e("BaseConfigure"):t._e()],1),e("el-tab-pane",{attrs:{label:"学院特色应用",name:"second"}},["second"===t.activeName?e("FeaturedApplication"):t._e()],1),e("el-tab-pane",{attrs:{label:"校园动态信息",name:"third"}},["third"===t.activeName?e("DynamicInfo"):t._e()],1)],1)],1)},o=[],s=function(){var t=this,e=t._self._c;return t.curSchool?e("div",[e("div",{staticClass:"btn-group"},["edit"==t.btnStatus?e("el-button",{attrs:{type:"success"},on:{click:t.handleEdit}},[t._v(" 编辑 ")]):t._e(),t.tableData&&0==t.tableData.status?e("el-button",{attrs:{type:"warning"},on:{click:t.syncData}},[t._v(" 同步 ")]):t._e()],1),e("OtherInfo",{attrs:{item:t.tableData,options:t.options,rows:t.tableColumn}}),e("Dialog",{ref:"editableDialogRef",attrs:{data:t.formData,"dialog-form":t.dialogForm,form:t.infoForm},on:{close:t.handleClose,submit:t.handleSubmit}})],1):t._e()},n=[],i=a("3f7a"),r=a("5d45"),c=a("ed08"),b=a("d936"),m=a("bad7"),u=a("61f7"),x=a("65b3");const d=[{type:"text",prop:"xxjgdm",label:"学校机构代码",disabled:!0},{type:"text",prop:"xxjgmc",label:"学校机构名称",disabled:!0},{type:"dateYm",prop:"jxrq",label:"建校日期"},{type:"text",prop:"xxjbzmc",label:"学校举办者名称"},{type:"select",prop:"xxjbzxz",label:"学校举办者性质",options:[],slot:!0,show:function(t,e){return Object(c["c"])(t,e,"xxjbzxz")}},{type:"select",prop:"xxjbzjb",label:"学校举办者级别",options:[],slot:!0,show:function(t,e){return Object(c["c"])(t,e,"xxjbzjb")}},{type:"select",prop:"xxxzlb",label:"学校性质类别",options:[],slot:!0,show:function(t,e){return Object(c["c"])(t,e,"xxxzlb")}},{type:"cascader",prop:"address",label:"所在地区",options:[],slot:!0,show:function(t){let e="";return t.provincejgmc&&(e+=t.provincejgmc),t.cityjgmc&&(e+=t.cityjgmc),t.countyjgmc&&(e+=t.countyjgmc),e}},{type:"select",prop:"gspxxxz",label:"高水平学校性质",options:[],slot:!0,show:function(t,e){return Object(c["c"])(t,e,"gspxxxz")}},{type:"select",prop:"gspxxjb",label:"高水平学校级别",options:[],slot:!0,show:function(t,e){return Object(c["c"])(t,e,"gspxxjb")}},{type:"text",prop:"gspxxlxbmmc",label:"高水平学校立项部门名称(全称)"},{type:"dateYm",prop:"gspxxpzsj",label:"高水平学校批准时间(年月)",options:[]},{type:"number",prop:"zyqsl",label:"专业群数量"},{type:"select",prop:"bxlx",label:"办学类型",options:[],slot:!0,show:function(t,e){return Object(c["c"])(t,e,"bxlx")}},{type:"number",prop:"xyjss",label:"现有教职工总数"},{type:"number",prop:"zjgrs",label:"专技岗人数"},{type:"number",prop:"glgrs",label:"管理岗人数"},{type:"number",prop:"gqgrs",label:"工勤岗人数"},{type:"number",prop:"xyxss",label:"现有学生数"},{type:"number",prop:"xxtsyys",label:"学校特色应用数"},{type:"select",prop:"syxx",label:"国家/省级双优学校",options:[],slot:!0,show:function(t,e){return Object(c["c"])(t,e,"syxx")}}],p={provincejgbm:null,provincejgmc:null,cityjgbm:null,cityjgmc:null,countyjgbm:null,countyjgmc:null,xxjgmc:null,xxjgdm:null,jxrq:null,xxjbzmc:null,xxjbzxz:null,xxjbzjb:null,xxxzlb:null,gspxxxz:null,gspxxjb:null,gspxxlxbmmc:null,gspxxpzsj:null,zyqsl:null,bxlx:null,xyjss:null,zjgrs:null,glgrs:null,gqgrs:null,xyxss:null,xxtsyys:null,syxx:null,status:0},h=[{type:"text",prop:"xxjgdm",label:"学校机构代码",disabled:!0,slot:!0,show:function(t){return t.xygkjcsjVo&&t.xygkjcsjVo.xxjgdm||""}},{type:"text",prop:"xxjgmc",label:"学校机构名称",disabled:!0,slot:!0,show:function(t){return t.xygkjcsjVo&&t.xygkjcsjVo.xxjgmc||""}},{type:"select",prop:"tsyyfl",label:"特色应用分类",slot:!0,show:function(t,e){return Object(c["c"])(t,e,"tsyyfl")}},{type:"text",prop:"tsyyjc",label:"特色应用简称"},{type:"text",prop:"tsyyqc",label:"特色应用全称"},{type:"text",prop:"tsyydydz",label:"特色应用调用地址"},{prop:"status",label:"同步状态",slot:"html",show:function(t){return Object(c["e"])(t)}}],g={xxjgdm:null,xxjgmc:null,tsyyfl:null,tsyyjc:null,tsyyqc:null,tsyydydz:null,status:0},y=[{type:"text",prop:"xxjgdm",label:"学校机构代码",disabled:!0,slot:!0,show:function(t){return t.xygkjcsjVo&&t.xygkjcsjVo.xxjgdm||""}},{type:"text",prop:"xxjgmc",label:"学校机构名称",disabled:!0,slot:!0,show:function(t){return t.xygkjcsjVo&&t.xygkjcsjVo.xxjgmc||""}},{type:"text",prop:"xydtxxbt",label:"标题"},{type:"text",prop:"xydtxxfbfwlj",label:"外部访问链接"},{type:"dateYmd",prop:"dtfbsj",label:"动态发布时间"},{prop:"status",label:"同步状态",slot:"html",show:function(t){return Object(c["e"])(t)}}],j={xxjgdm:null,xxjgmc:null,xydtxxbt:null,xydtxxfbfwlj:null,dtfbsj:null,status:0};var f={components:{Dialog:i["a"],OtherInfo:r["a"]},data(){return{activeName:"notSync",btnStatus:"add",options:{key:["xxjbzxz","xxjbzjb","xxxzlb","gspxxxz","gspxxjb","bxlx","syxx"],data:{xxjbzxz:[],xxjbzjb:[],xxxzlb:[],gspxxxz:[],gspxxjb:[],bxlx:[],syxx:[]}},dialogForm:{show:!1,title:"学院概况",btnLoading:!1,width:"80%",rowClass:"",initForm:p,rules:{gspxxxz:{required:!0,message:"请选择学校性质",trigger:"change"},gspxxjb:{required:!0,message:"请选择学校级别",trigger:"change"},gspxxlxbmmc:{required:!0,message:"请输入立项部门名称",trigger:"blur"},gspxxpzsj:{required:!0,message:"请选择批准时间",trigger:"change"},syxx:{required:!0,message:"请选择",trigger:"change"},zyqsl:[u["h"]],xyjss:[u["h"]],zjgrs:[u["h"]],glgrs:[u["h"]],gqgrs:[u["h"]],xyxss:[u["h"]],xxtsyys:[u["h"]]},treeData:[],getAreaCode:(t,e)=>{let a={provincejgbm:null,provincejgmc:null,cityjgbm:null,cityjgmc:null,countyjgbm:null,countyjgmc:null};return t&&t.length&&t.forEach((t,l)=>{const o=e.filter(e=>e.code===t);0==l?(a.provincejgmc=o[0].name,a.provincejgbm=o[0].code):1==l?(a.cityjgmc=o[0].name,a.cityjgbm=o[0].code):2==l&&(a.countyjgmc=o[0].name,a.countyjgbm=o[0].code)}),a}},tableData:{},infoForm:{...p},tableColumn:d,curSchool:null}},computed:{formData(){let t=[],e=0;while(e<this.tableColumn.length)t.push(this.tableColumn.slice(e,e+=3));return t}},watch:{"$store.state.user.schoolId":{handler(t){this.initFun()}}},mounted(){this.initFun()},methods:{async initFun(){const t=await Object(b["d"])();this.curSchool=t,t?(this.getOPtions(),this.getAddress(),this.dialogForm.initForm={...this.dialogForm.initForm,...t},this.infoForm={...this.infoForm,...t},this.getSchoolProfile()):this.$message({type:"warning",message:"无相关学校，请先注册或选中相关学校！",duration:0,showClose:!0})},getOPtions(){this.options.key.forEach(t=>{const e=t+"dm";Object(x["e"])(e).then(e=>{this.options.data[t]=e,this.tableColumn.forEach(a=>{if(a.prop==t)return a.options=e,!1})}).catch(t=>{console.log(t)})})},getAddress(){Object(b["c"])().then(t=>{if(t&&t.length){this.dialogForm.treeData=t;const e=Object(c["a"])(t);this.tableColumn[7].options=e}})},getSchoolProfile(){return this.curSchool?Object(b["e"])(this.curSchool.odsXygkjcsjId).then(t=>{t?(this.btnStatus="edit",this.tableData=t):(this.btnStatus="add",this.tableData={})}):{}},handleAdd(){this.dialogForm.show=!0,this.dialogForm.title="新增学院概况"},async handleEdit(){await this.getSchoolProfile(),1==this.tableData.status?Object(b["g"])(this.tableData.id).then(()=>{this.editRow(this.tableData)},t=>{if(t.includes("ID")){const e=t.split("=")[1];console.log(e),this.$confirm(t+", 该操作将从同步记录表中撤销该条数据, 是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.revokeRow(e).then(t=>{t&&this.editRow()})})}}):this.editRow()},editRow(){this.dialogForm.show=!0,this.dialogForm.title="编辑学院概况",Object(u["a"])(this.tableData,"gspxxpzsj");const t=[];this.tableData.provincejgbm&&(t.push(Number(this.tableData.provincejgbm)),this.tableData.cityjgbm&&(t.push(Number(this.tableData.cityjgbm)),this.tableData.countyjgbm&&t.push(Number(this.tableData.countyjgbm)))),this.infoForm=Object.assign({},this.tableData,{address:t})},handleDelete(){this.$confirm("该操作将删除学院概况, 是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Object(b["b"])(this.tableData.id).then(()=>{this.$message.success("删除成功!"),this.getSchoolProfile()}).catch(()=>{this.$message.info("已取消")})})},handleClose(){this.dialogForm.show=!1,this.getSchoolProfile()},handleSubmit(t){this.dialogForm.btnLoading=!0;const e="新增学院概况"===this.dialogForm.title?Object(b["a"])(t):Object(b["h"])(t.id,t);e.then(t=>{this.$refs["editableDialogRef"].resetForm(),this.handleClose(),this.$message.success(this.dialogForm.title+"成功")}).finally(()=>{this.dialogForm.btnLoading=!1})},revokeRow(t){return Object(m["a"])(t).then(()=>Promise.resolve(!0))},syncData(){Object(b["i"])(this.tableData.id).then(t=>{this.$message.success("同步成功"),this.getSchoolProfile()})}}},F=f,D=(a("ad07"),a("2877")),w=Object(D["a"])(F,s,n,!1,null,"ac843694",null),v=w.exports,z=function(){var t=this,e=t._self._c;return t.curSchool?e("div",[e("QueryForm",{attrs:{data:t.queryFormData,form:t.queryForm},on:{add:t.handleAdd,search:t.searchFun}}),e("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.tableParams.activeName,callback:function(e){t.$set(t.tableParams,"activeName",e)},expression:"tableParams.activeName"}},[e("el-tab-pane",{attrs:{label:"未同步",name:"notSync"}}),e("el-tab-pane",{attrs:{label:"已同步",name:"sync"}})],1),e("DisplayTable",{attrs:{column:t.tableColumn,data:t.tableData,"table-params":t.tableParams},on:{delete:t.handleDelete,edit:t.handleEdit,search:t.searchFun,sync:t.syncData}}),e("Dialog",{ref:"editableDialogRef",attrs:{data:t.formData,"dialog-form":t.dialogForm,form:t.infoForm},on:{close:t.handleClose,submit:t.handleSubmit}})],1):t._e()},O=[],k=a("5d9c"),C=a("5f9b"),S=a("e8b7"),q={components:{Dialog:i["a"],DisplayTable:C["a"],QueryForm:S["a"]},mixins:[k["a"]],data(){return{apiUrl:"/cms/xydtxx",activeName:"notSync",dialogForm:{show:!1,title:"",staticTitle:"校园动态信息",btnLoading:!1,width:"600px",formLabelWidth:"110px",rowClass:"column",initForm:j,rules:{xydtxxbt:{required:!0,message:"请输入标题",trigger:"blur"}}},queryForm:{xydtxxbt:null,xxjgdm:null},queryFormData:[{type:"text",prop:"xydtxxbt",label:"动态信息标题"}],tableData:[],infoForm:{...j},tableColumn:y,tableParams:{activeName:"notSync",loading:!1,expand:!1,colLen:0,total:0}}},methods:{editRow(t){Object(u["a"])(t,"dtfbsj"),this.infoForm={...t},this.dialogForm.show=!0,this.dialogForm.title="编辑校园动态信息"}}},N=q,P=Object(D["a"])(N,z,O,!1,null,"48fa18b6",null),_=P.exports,R=function(){var t=this,e=t._self._c;return t.curSchool?e("div",[e("QueryForm",{attrs:{data:t.queryFormData,form:t.queryForm},on:{add:t.handleAdd,search:t.searchFun}}),e("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.tableParams.activeName,callback:function(e){t.$set(t.tableParams,"activeName",e)},expression:"tableParams.activeName"}},[e("el-tab-pane",{attrs:{label:"未同步",name:"notSync"}}),e("el-tab-pane",{attrs:{label:"已同步",name:"sync"}})],1),e("DisplayTable",{attrs:{column:t.tableColumn,data:t.tableData,options:t.options,"table-params":t.tableParams},on:{delete:t.handleDelete,edit:t.handleEdit,search:t.searchFun,sync:t.syncData}}),e("Dialog",{ref:"editableDialogRef",attrs:{data:t.formData,"dialog-form":t.dialogForm,form:t.infoForm},on:{close:t.handleClose,submit:t.handleSubmit}})],1):t._e()},T=[],$={components:{Dialog:i["a"],DisplayTable:C["a"],QueryForm:S["a"]},mixins:[k["a"]],data(){return{apiUrl:"/cms/xytsyy",options:{key:["tsyyfl"],data:{tsyyfl:[]}},dialogForm:{show:!1,title:"",staticTitle:"学院特色应用",btnLoading:!1,width:"600px",rowClass:"column",initForm:g,rules:{tsyyfl:{required:!0,message:"请选择特色应用分类",trigger:"change"}}},queryForm:{tsyyfl:null,xxjgdm:null},queryFormData:[{type:"select",prop:"tsyyfl",label:"特色应用分类",options:[]}],tableData:[],infoForm:{...g},tableColumn:h,tableParams:{loading:!1,expand:!1,colLen:0,total:0,activeName:"notSync"}}},watch:{"options.data":{handler:function(t){t&&(this.queryFormData[0].options=t["tsyyfl"])},deep:!0,immediate:!0}},methods:{getOPtions(){this.options.key.forEach(t=>{const e=t+"dm";Object(x["e"])(e).then(e=>{this.options.data[t]=e,this.tableColumn.forEach(a=>{if(a.prop==t)return a.options=e,!1})}).catch(t=>{console.log(t)})})},editRow(t){this.infoForm={...t},this.dialogForm.show=!0,this.dialogForm.title="编辑"+this.dialogForm.staticTitle}}},E=$,A=Object(D["a"])(E,R,T,!1,null,"69d0bfaf",null),L=A.exports,V={components:{BaseConfigure:v,DynamicInfo:_,FeaturedApplication:L},data(){return{activeName:"first"}},mounted(){}},I=V,B=Object(D["a"])(I,l,o,!1,null,"9ad883da",null);e["default"]=B.exports},ad07:function(t,e,a){"use strict";a("ebe3")},ebe3:function(t,e,a){}}]);